# 列设置高级功能演示

## 🎯 功能概览

表格工具栏的列设置现在支持多种高级功能：拖拽排序、列固定、显示/隐藏等！

```
┌─────────────────────────────────────────────────────────┐
│  列展示                                     重置         │
├─────────────────────────────────────────────────────────┤
│  ⋮⋮ ☑ ID                        [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 用户名                    [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 昵称                      [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 邮箱                      [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 手机号                    [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 状态                      [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
│  ⋮⋮ ☑ 操作                      [|◀] [|—|] [▶|]       │  ← 可拖拽 + 固定
└─────────────────────────────────────────────────────────┘

图例：
⋮⋮ 拖拽手柄    ☑ 显示/隐藏    [|◀] 左固定    [|—|] 不固定    [▶|] 右固定
```

## ✨ 核心功能

### 1. 拖拽排序 🔄
- **拖拽图标**：每列左侧显示 `⋮⋮` 图标，提示可以拖拽
- **拖拽操作**：按住图标拖动到目标位置
- **实时反馈**：
  - 拖拽中的项会有半透明效果（opacity: 0.5）
  - 背景色变为浅蓝色 `#e6f7ff`
  - 鼠标悬停时背景色为 `#f5f5f5`

### 2. 列固定 📌
- **固定选项**：鼠标悬停时右侧显示三个固定按钮
  - `|◀` 左固定：将列固定在表格左侧
  - `|—|` 不固定：取消列的固定状态
  - `▶|` 右固定：将列固定在表格右侧
- **视觉反馈**：当前激活的按钮会高亮显示（蓝色）
- **实时更新**：点击后表格列立即应用固定效果

### 3. 显示/隐藏 👁️
- **复选框**：每列都有一个复选框
- **勾选控制**：勾选显示，取消勾选隐藏
- **智能限制**：至少保留一列可见

### 4. 重置功能 🔄
- 点击右上角"重置"按钮
- 一键恢复到原始状态：
  - 列的显示/隐藏状态
  - 列的排序顺序
  - 列的固定状态
- 显示"已重置列设置"提示消息

### 5. 视觉优化 🎨
- 更现代的 UI 设计
- 清晰的头部分隔线
- 平滑的过渡动画（transition: all 0.2s）
- 用户友好的交互提示
- 按钮悬停效果

## 🎨 交互演示

### 拖拽前
```
1. ID
2. 用户名
3. 昵称
4. 邮箱
5. 手机号
```

### 拖拽操作
```
用户想把"邮箱"移到"用户名"后面：
1. 按住"邮箱"左侧的 ⋮⋮ 图标
2. 向上拖动
3. 释放鼠标
```

### 拖拽后
```
1. ID
2. 用户名
3. 邮箱      ← 位置已改变
4. 昵称
5. 手机号
```

### 表格列顺序同步更新
表格的列会按照新的顺序重新排列！

## 🔧 技术实现

### 使用技术
- **HTML5 拖拽 API**：原生实现，无需额外依赖
- **Vue 3 响应式**：实时更新列顺序
- **事件驱动**：通过事件通知父组件更新

### 核心事件
- `dragstart` - 开始拖拽
- `dragover` - 拖拽经过
- `drop` - 放置
- `dragend` - 结束拖拽

### 状态管理
```typescript
sortedColumns: Column[]    // 当前排序后的列
draggedIndex: number      // 正在拖拽的索引
originalColumns: Column[] // 原始列配置（用于重置）
```

## 📝 使用示例

### 基础使用
```vue
<template>
  <TableToolbar
    :columns="currentColumns"
    :visible-column-keys="visibleColumns"
    @column-order-change="handleColumnOrderChange"
  />
</template>

<script setup>
import { ref } from 'vue'

const currentColumns = ref([...originalColumns])

const handleColumnOrderChange = (columns) => {
  currentColumns.value = columns
  console.log('新顺序:', columns.map(c => c.title))
}
</script>
```

### 持久化存储
```vue
<script setup>
// 保存到 localStorage
const handleColumnOrderChange = (columns) => {
  currentColumns.value = columns
  localStorage.setItem('table_column_order', JSON.stringify(columns))
}

// 页面加载时恢复
onMounted(() => {
  const saved = localStorage.getItem('table_column_order')
  if (saved) {
    try {
      currentColumns.value = JSON.parse(saved)
    } catch (e) {
      console.error('恢复列顺序失败:', e)
    }
  }
})
</script>
```

## 🎁 额外特性

### 智能限制
- 至少保留一列可见（不能全部取消勾选）
- 拖拽时自动阻止默认行为
- 防止意外操作

### 用户体验
- 平滑的动画过渡
- 清晰的视觉反馈
- 直观的拖拽图标
- 一键重置功能

### 性能优化
- 原生实现，无额外依赖
- 轻量级代码
- 快速响应

## 🚀 快速上手

1. **打开列设置面板**
   点击表格右上角的 ⚙️ 按钮

2. **拖拽调整顺序**
   按住列项左侧的 ⋮⋮ 图标，拖动到目标位置

3. **查看效果**
   表格列会立即按新顺序重新排列

4. **重置（可选）**
   点击"重置"按钮恢复默认设置

## 🎯 组合使用场景

### 场景一：常用列组合
1. 固定"ID"列在左侧
2. 固定"操作"列在右侧
3. 隐藏不常用的"备注"列
4. 拖拽调整其他列的顺序

### 场景二：个性化配置
1. 根据业务需求调整列顺序
2. 固定关键列便于查看
3. 隐藏冗余列简化界面
4. 保存配置到 localStorage

### 场景三：快速恢复默认
1. 尝试各种配置后
2. 点击"重置"按钮
3. 一键恢复初始状态

## 💡 使用提示

- **拖拽图标** `⋮⋮`：始终可见，拖拽时有反馈
- **固定按钮**：鼠标悬停时显示，激活时高亮
- **组合操作**：可同时使用拖拽、固定、显示/隐藏
- **重置功能**：恢复所有设置到初始状态
- **持久化**：建议配合 localStorage 保存用户偏好

## 📌 兼容性

- ✅ Chrome / Edge (推荐)
- ✅ Firefox
- ✅ Safari
- ✅ 现代浏览器均支持 HTML5 拖拽 API

## 📚 相关文档

- [TableToolbar 组件文档](./README.md) - 完整的 API 文档
- [列固定功能演示](./COLUMN_FIXED_DEMO.md) - 详细的列固定功能说明

---

**更新时间**: 2025-10-28  
**版本**: v1.2.0  
**功能列表**: 
- ✅ 拖拽排序
- ✅ 列固定（左固定/右固定）
- ✅ 显示/隐藏
- ✅ 一键重置

